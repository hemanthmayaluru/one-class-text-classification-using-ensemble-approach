{"title": "In silico generation of novel, drug-like chemical matter using the LSTM  neural network", "tag": "q-bio", "abstract": " The exploration of novel chemical spaces is one of the most important tasks of cheminformatics when supporting the drug discovery process. Properly designed and trained deep neural networks can provide a viable alternative to brute-force de novo approaches or various other machine-learning techniques for generating novel drug-like molecules. In this article we present a method to generate molecules using a long short-term memory (LSTM) neural network and provide an analysis of the results, including a virtual screening test. Using the network one million drug-like molecules were generated in 2 hours. The molecules are novel, diverse (contain numerous novel chemotypes), have good physicochemical properties and have good synthetic accessibility, even though these qualities were not specific constraints. Although novel, their structural features and functional groups remain closely within the drug-like space defined by the bioactive molecules from ChEMBL. Virtual screening using the profile QSAR approach confirms that the potential of these novel molecules to show bioactivity is comparable to the ChEMBL set from which they were derived. The molecule generator written in Python used in this study is available on request. ", "text": "exploration novel chemical spaces important tasks cheminformatics supporting drug discovery process. properly designed trained deep neural networks provide viable alternative bruteforce novo approaches various machine-learning techniques drug-like molecules. article present method generate molecules using long short-term memory neural network provide analysis results including virtual screening test. using network million drug-like molecules generated hours. molecules novel diverse good physicochemical properties good synthetic accessibility even though qualities specific constraints. although novel structural features functional groups remain closely within drug-like space defined bioactive molecules chembl. virtual screening using profile qsar approach confirms potential novel molecules show bioactivity comparable chembl derived. molecule generator written python used study available request. drug molecules) currently possible. needs utilize various sophisticated cheminformatics algorithms sample representative chemical space generate novel molecules interest example combination drug-like fragments evolutionary algorithms particle swarm optimization. review provides good overview molecule generating methods. recent advances neural networks opened avenue interesting molecules. particularly recently introduced long shortterm memory networks well suited purpose. inner working lstm network quite complex detailed description beyond scope article. simply speaking thanks sophisticated exploration novel chemical spaces important tasks cheminformatics supporting drug discovery. address problem brute force approach reasonable molecules within certain size constraints. combinatorial explosion number possible molecules generated increasing size approach currently possible relatively small molecules. example gdb- database containing billion molecules full enumeration however molecules atoms tensorflow numerical backend engine used project. popular software tools written python make development application deep neural networks relatively easy allowing focus scientific aspects problem rather details numerical implementation. major challenge application lstm networks design proper network architecture. optimal combination various network parameters requires trial error. general rules designing optimal architecture experiment different architectures parameters. several experiments network architecture shown fig. selected study. network consists double lstm layers dropout layer output dense layer neurons softmax activation function. default rmsprop optimizer used training. training necessary continually decrease learning rate using generate structures novel molecules certain level randomness added diverse structures closely reproduce molecules training set. learn characteristics objects trained answer questions objects even generate similar objects. lstm networks used support many sophisticated technologies including speech recognition language translation smart mobile phone assistants self-driving cars also numerous lighter applications nicely document power lstm algorithm described. trained shakespeare’s plays network able create novel shakespeare sonnets trained classical piano music compose songs characteristics described make lstm recurrent neural network also good candidate cheminformatics applications particularly generation novel chemical matter. lstm neural networks generate novel molecules desired properties topic several academic well industrial groups exploring area. bjerrum threlfall used molecules zinc database train lstm network generate novel molecules. samples molecules checked using retrosynthetic planning software retrosynthetic route could identified them. several variations training smiles shown provide better single canonical representation gomez-bombarelli trained encoder-decoder network encoder converting molecule vector latent space decoder converting molecular structure. operation continuous latent space allowed design various drug-like molecules light-emitting diodes. olivecrona designed network generate molecules desired properties including analogues query structure molecules increased probability active certain biological targets. segler used molecules generated lstm recurrent network design several focused libraries targeting serotonin receptor several antibacterial targets. lstm networks also successfully applied retrosynthetic reaction prediction trained sequence-to-sequence reaction prediction network reactions patents. method performed comparably rule-based expert system. yang combined monte carlo tree search recurrent neural network generate molecules desired values octanol-water partition coefficient good synthesizability. recently gupta presented application recurrent networks novo drug design fragmentbased drug discovery. submission process manuscript study popova appeared describing computational strategy novo drug design based deep reinforced learning. molecules training chembl set. similarity distribution generated molecules chembl compounds shown fig. standard rdkit similarity based morgan fingerprints tanimoto coefficient used million generated structures contained thousand unique scaffolds comparison chembl training contained thousand scaffolds. overlap sets thousand scaffolds. data illustrate protocol generates novel molecules mirror training closely. generated molecules also good properties. calculated common molecular descriptors shown figure similar chembl set. table counts important substructure features chembl training molecules generated lstm network shown. table also contains column showing statistics molecules generated simple naive smiles generator analysis wanted whether intelligence deep lstm neural network necessary generate valid molecules whether simple smiles generator using syntax smiles language basic statistics derived reference database known structures sufficient. tool analyzed training provide frequencies occurrence atom types average number symbols pairing operations used roulette wheel probabilities. smiles generation started picking element according frequency string filled character character symbols rings branches. aromatic miles codes bioactive molecules chembl database used train network. smiles codes filtered slightly modified make training easier. molecules containing organic subset atoms used. charged molecules discarded stereo information considered. molecules ring closures retained training set. atomic codes consisting multiple characters case) replaced single character codes modification training corpus consisted characters whole training corpus contained characters. training process sequences characters corpus network together character following sequence. goal training learn character preceding sequence. process lstm network learned smiles grammar learned character probably follow certain group characters. python code used generate molecules study available download additional file. smiles codes generated character-by-character using trained lstm neural network. smiles codes generated fully grammatically correct. therefore first step checked whether brackets ring closure numbers paired. test could performed relatively fast simple text query without necessity parse smiles. generated smiles codes could discarded test. additional discarded full chemical parsing using rdkit unrealistic aromatic systems incorrect atomic valences. generated smiles strings correct molecules. generation million correct molecules required less hours cpus. switching gpus increasing number processors would allow generation hundreds millions even billions molecules weekend. answer concerned quality generated molecules. million molecules generated identical lements could added ring closures. smiles string parsed using rdkit represents valid molecule. analysis clearly shows structures generated lstm neural network distribution substructure features similar chembl molecules naive smiles generator using knowledge statistical distribution characters smiles strings basic smiles syntactic rules generates ugly molecules mostly macrocycles practically fused aromatic systems able reproduce chemical space chembl molecules. figure comparisons predicted cumulative frequency distributions actual generated compounds best chembl kinase profile-qsar models. models correlation prediction experiment challenging realistic test sets. chembl kinase assays many models good prediction ability. predictions models correlated experiment held-out test sets novel possible compounds. training generated molecule sets also calculated synthetic accessibility score measure easy might synthesize molecule. distribution score practically identical sets indicating generated structures similar complexity drug-like molecules chembl database. summary generated structures novel little overlap training diverse containing large number novel scaffolds properties range drug-like chembl molecules. substructure analysis distribution functional groups newly generated molecules indicates lstm network able learn drug-like structural features training well introduce newly generated structures. likelihood novel molecules showing bioactivity profiles comparable actual chembl molecules assessed virtual screening. profile-qsar multi-target virtual screening models previously reported activity actual chembl structures generated structures predicted models. figure overlays cumulative frequency distributions predicted actual generated chembl compounds models. overlays almost perfect indicating generated compounds similar likelihoods biological activity actual chembl compounds. kolmogorov-smirnov test quantitatively compares curves examining largest vertical distance curves. test applied random samplings compounds model. table shows results test along means standard deviations activity distributions actual generated compounds models. models test allows null hypothesis distributions confidence. assays test rejects null hypothesis distributions confidence even worst case largest vertical distance within assay pairs means standard deviations actual generated distributions coincide closely much closer variation means standard deviations assays indicating generated actual compounds would similar activity profiles. chembl assay kolmogorov smirnov statistic maximum vertical distance cumulative frequency distribution curves. critical value alpha=. .%.if d>.% distributions different confidence. mean predicted activity real chembl compounds mean predicted activity generated chembl compounds standard deviation predicted activities real chembl compounds standard deviation predicted activities generated chembl compounds designed network performed generation molecules cheminformatics analysis wrote naive smiles generator performed virtual screening analyzed results. authors wrote article together. want thank following novartis colleagues helped suggestions discussing results niko fechner brian kelley stephan reiling bernd rohde gianluca santarossa nadine schneider ansgar schuffenhauer lingling shen finton sirockin clayton springer stiefl wolfgang zipfel. lstm neural networks used generate novel molecules based training thousand drug-like molecules chembl database. generated structures novel diverse good properties synthetic accessibility. although novel molecules occupy area chemical space known bioactive molecules. virtual screening indicates generated molecules comparable probability activity various targets. performance algorithm sufficient generated hundreds millions even billions drug-like molecules. novel structures generated used virtual screening exploring novel interesting areas chemical universe. python code used train lstm network generate smiles codes molecules described article available author request. gaulton bellis bento chambers davies hersey light mcglinchey michalovich al-lazikani overington chembl large-scale bioactivity database drug discovery. nucleic acids ;d–d cheminformatics ertl rohde selzer fast calculation molecular polar surface area fragment-based contributions application prediction drug transport properties. chem martin polyakov tian perez profile-qsar kinase virtual screening accuracy comparable four concentration realistically novel compounds. chem model gomez-bombarelli duvenaud hernandez-lobato aguilera-iparraguirre hirzel adams aspuru-guzik automatic chemical design using data-driven continuous representation molecules. arxiv", "year": "2017"}